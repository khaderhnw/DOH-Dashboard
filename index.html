<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Issue a Newborn Digital Birth Certificate ‚Äì Prototype</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #f1f5f9;
      margin: 0;
    }
    .phone-shell {
      max-width: 430px;
      margin: 0 auto;
      background-color: #ffffff;
    }
    @media (min-width: 768px) {
      .phone-shell {
        margin-top: 16px;
        margin-bottom: 16px;
        border-radius: 32px;
        box-shadow: 0 20px 40px rgba(15, 23, 42, 0.18);
        overflow: hidden;
      }
    }
    .animate-fade-in {
      animation: fadeIn 0.4s ease-out forwards;
    }
    .animate-slide-up {
      animation: slideUp 0.4s ease-out forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from { transform: translateY(16px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel" data-presets="env,react">
    const { useState, useEffect } = React;

    // ---------- Small helpers ----------

    const EmojiIcon = ({ symbol }) => (
      <span className="inline-block w-5 text-center">{symbol}</span>
    );

    const Card = ({ children, className = "" }) => (
      <div className={"bg-white rounded-3xl border border-slate-200 shadow-sm " + className}>
        {children}
      </div>
    );

    const Button = ({
      children,
      onClick,
      variant = "primary",
      className = "",
      disabled = false
    }) => {
      const base =
        "px-4 py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition active:scale-95";
      const styles = {
        primary: "bg-teal-700 text-white hover:bg-teal-800",
        secondary: "bg-white text-slate-800 hover:bg-slate-50 border border-slate-200",
        ghost: "bg-transparent text-teal-700 hover:bg-teal-50"
      };
      return (
        <button
          onClick={onClick}
          disabled={disabled}
          className={
            base +
            " " +
            (styles[variant] || "") +
            " " +
            className +
            (disabled ? " opacity-40 cursor-not-allowed" : "")
          }
        >
          {children}
        </button>
      );
    };

    // ---------- CRM DATA (simplified) ----------

    const CRM_GLOBAL = {
      totalCases: 762,
      payment: { count: 190, share: 25 },
      technical: { count: 396, share: 52 }
    };

    const CRM_STAGES = {
      service: {
        label: "Service overview",
        totalCases: 762,
        share: 100,
        topCategory: "Technical & payment issues",
        examples: [
          "Parents report difficulty finding the correct newborn digital birth certificate service inside TAMM.",
          "Several cases mention confusion between certificates, copies, and attestation options."
        ]
      },
      notification: {
        label: "Notification selection",
        totalCases: 7,
        share: 1,
        topCategory: "Technical issues when selecting notification",
        examples: [
          "Case 240909‚Äë5038613: ‚ÄúWhen I select the birth notification number, an unexpected error appears and I cannot move to the next step.‚Äù",
          "Case 240924‚Äë5103975: ‚ÄúI tried to apply using the birth notification but there was a problem and I could not proceed.‚Äù"
        ]
      },
      documents: {
        label: "Upload documents",
        totalCases: 41,
        share: 5,
        topCategory: "Document upload & eligibility issues",
        examples: [
          "‚ÄúOnce I submit all required documents I get an error and the page does not move forward in the newborn digital birth certificate service.‚Äù",
          "‚ÄúThe system shows that I am not eligible even though I have attached the birth notification and documents.‚Äù"
        ]
      },
      naming: {
        label: "Baby details / naming",
        totalCases: 5,
        share: 1,
        topCategory: "Freezing & wrong name details",
        examples: [
          "‚ÄúWhen I try to complete the newborn details the form freezes and I cannot reach the payment step.‚Äù",
          "‚ÄúThe name for my baby is shown incorrectly and I cannot edit it in the service.‚Äù"
        ]
      },
      payment: {
        label: "Payment",
        totalCases: 198,
        share: 26,
        topCategory: "Payment captured but status still pending",
        examples: [
          "‚ÄúI already paid for the newborn birth certificate but the application still says ‚Äòpending payment‚Äô and I cannot download the certificate.‚Äù",
          "‚ÄúThere was an error during payment so I could not complete the service.‚Äù"
        ]
      },
      status: {
        label: "Processing & issuance",
        totalCases: 57,
        share: 7,
        topCategory: "Request stuck in progress / late rejection",
        examples: [
          "‚ÄúMy newborn‚Äôs digital birth certificate request has been in progress for many days and has not been issued.‚Äù",
          "‚ÄúThe request was later rejected due to a name error with no clear way to correct and resubmit.‚Äù"
        ]
      }
    };

    // ---------- AI name library (gender + initial + meaning) ----------

    const NAME_LIBRARY = [
      {
        en: "Zayed",
        ar: "ÿ≤ÿßŸäÿØ",
        gender: "boy",
        initial: "Z",
        meaning: "Growth; one who increases in goodness."
      },
      {
        en: "Khalifa",
        ar: "ÿÆŸÑŸäŸÅÿ©",
        gender: "boy",
        initial: "K",
        meaning: "Successor; leader."
      },
      {
        en: "Hamdan",
        ar: "ÿ≠ŸÖÿØÿßŸÜ",
        gender: "boy",
        initial: "H",
        meaning: "One who gives thanks often."
      },
      {
        en: "Maryam",
        ar: "ŸÖÿ±ŸäŸÖ",
        gender: "girl",
        initial: "M",
        meaning: "Beloved; virtuous and devout."
      },
      {
        en: "Fatima",
        ar: "ŸÅÿßÿ∑ŸÖÿ©",
        gender: "girl",
        initial: "F",
        meaning: "Pure; one who abstains from what is wrong."
      },
      {
        en: "Lana",
        ar: "ŸÑÿßŸÜÿß",
        gender: "girl",
        initial: "L",
        meaning: "Gentle; soft and kind."
      }
    ];

    // ---------- CRM snippet ----------

    const CRMPanel = ({ stageKey, onSeeToBe }) => {
      const data = CRM_STAGES[stageKey];
      if (!data) return null;
      return (
        <div className="mt-4 bg-slate-50 border border-slate-200 rounded-2xl p-3 text-xs">
          <div className="flex justify-between mb-1">
            <span className="font-semibold text-slate-700">
              CRM hotspot ‚Äì {data.label}
            </span>
            <span className="inline-flex items-center px-2 py-0.5 rounded-full bg-rose-50 text-rose-700 text-[10px] font-semibold">
              <EmojiIcon symbol="‚ö†Ô∏è" /> Pain point
            </span>
          </div>
          <p className="text-slate-600">
            {data.totalCases} complaints ¬∑ {data.share}% of all cases ‚Äì mainly{" "}
            <span className="font-semibold">{data.topCategory}</span>.
          </p>
          <ul className="mt-2 space-y-1 list-disc list-inside">
            {data.examples.slice(0, 2).map((t, i) => (
              <li key={i} className="text-slate-500">
                {t}
              </li>
            ))}
          </ul>
          <div className="mt-2 flex gap-2">
            <Button
              variant="secondary"
              className="flex-1 h-8 text-[11px]"
            >
              View CRM details
            </Button>
            <Button
              variant="ghost"
              className="flex-1 h-8 text-[11px]"
              onClick={onSeeToBe}
            >
              See To‚ÄëBe fix ‚Üí
            </Button>
          </div>
        </div>
      );
    };

    // ---------- Screens ----------

    const Splash = ({ onNext }) => {
      useEffect(() => {
        const t = setTimeout(onNext, 1500);
        return () => clearTimeout(t);
      }, [onNext]);

      return (
        <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-teal-900 to-teal-700 text-white">
          <div className="phone-shell h-screen flex flex-col items-center justify-center relative overflow-hidden">
            <div className="w-24 h-24 rounded-3xl bg-white/10 border border-white/20 flex items-center justify-center mb-6 shadow-xl">
              <EmojiIcon symbol="üì±" />
            </div>
            <h1 className="text-4xl font-bold tracking-tight">TAMM</h1>
            <p className="text-teal-200 text-xs mt-2 tracking-[0.25em] uppercase">
              Abu Dhabi Government
            </p>
            <div className="absolute bottom-10 text-xs text-teal-100 flex items-center gap-2">
              <span className="animate-pulse">‚óè</span>
              Loading your services‚Ä¶
            </div>
          </div>
        </div>
      );
    };

    const UAEPassLogin = ({ onLogin }) => {
      const [loading, setLoading] = useState(false);
      const handle = () => {
        setLoading(true);
        setTimeout(() => {
          setLoading(false);
          onLogin();
        }, 1500);
      };

      return (
        <div className="min-h-screen flex items-center justify-center bg-slate-50">
          <div className="phone-shell h-screen flex flex-col items-center justify-center px-6">
            <div className="w-full max-w-sm">
              {!loading ? (
                <>
                  <div className="text-center mb-10">
                    <h1 className="text-3xl font-bold text-slate-900 mb-2">
                      Welcome
                    </h1>
                    <p className="text-slate-500 text-sm">
                      Sign in securely with UAE PASS to access your newborn services.
                    </p>
                  </div>
                  <Card className="p-7 mb-4">
                    <div className="flex justify-center mb-6">
                      <div className="w-16 h-16 rounded-2xl bg-slate-900 text-white flex flex-col items-center justify-center text-[10px] font-bold leading-tight">
                        <span>UAE</span>
                        <span>PASS</span>
                      </div>
                    </div>
                    <Button
                      variant="primary"
                      className="w-full h-11 text-sm bg-slate-900 hover:bg-slate-800"
                      onClick={handle}
                    >
                      <EmojiIcon symbol="üîê" /> Login with UAE PASS
                    </Button>
                  </Card>
                  <p className="text-[11px] text-center text-slate-400">
                    Your identity is verified by UAE PASS. No password is stored in TAMM.
                  </p>
                </>
              ) : (
                <div className="flex flex-col items-center animate-fade-in">
                  <div className="w-28 h-28 bg-white rounded-3xl shadow-xl border-4 border-slate-900 flex items-center justify-center mb-6 relative overflow-hidden">
                    <EmojiIcon symbol="üåÄ" />
                  </div>
                  <h2 className="text-xl font-semibold text-slate-900">
                    Verifying identity‚Ä¶
                  </h2>
                  <p className="text-slate-500 text-sm mt-1">
                    Confirm the request in your UAE PASS app.
                  </p>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    // --------- HOME (search for service like TAMM) ---------

    const Home = ({ onSelectService }) => {
      const [query, setQuery] = useState("");

      const services = [
        {
          id: "newborn-cert",
          title: "Issue a Newborn Digital Birth Certificate",
          entity: "Department of Health"
        },
        {
          id: "age-estimation",
          title: "Issue a Digital Age Estimation Certificate",
          entity: "Department of Health"
        },
        {
          id: "true-copy",
          title: "Issue True Copy Certificate",
          entity: "General Administration of Customs - Abu Dhabi"
        }
      ];

      const filtered = services.filter((s, idx) => {
        if (!query) {
          // no search -> only highlight the main service like TAMM assistant
          return idx === 0;
        }
        return s.title.toLowerCase().includes(query.toLowerCase());
      });

      return (
        <div className="min-h-screen flex items-center justify-center bg-slate-50">
          <div className="phone-shell h-screen flex flex-col">
            {/* Top hero */}
            <div className="bg-gradient-to-b from-teal-800 to-teal-700 text-white px-4 pt-10 pb-6 rounded-b-3xl shadow-md">
              <div className="flex items-center justify-between mb-5">
                <div>
                  <p className="text-[11px] text-teal-200">How can I assist you?</p>
                  <p className="text-xl font-semibold">Search for a service</p>
                </div>
                <div className="w-9 h-9 rounded-full bg-white/20 flex items-center justify-center">
                  <EmojiIcon symbol="üôÇ" />
                </div>
              </div>
              <div className="bg-white rounded-full px-3 py-2 flex items-center gap-2 shadow-sm">
                <EmojiIcon symbol="üîç" />
                <input
                  className="flex-1 border-none outline-none text-sm text-slate-800"
                  placeholder="Issue a Newborn Digital Birth Certificate"
                  value={query}
                  onChange={(e) => setQuery(e.target.value)}
                />
                {query && (
                  <button
                    onClick={() => setQuery("")}
                    className="text-xs text-slate-400"
                  >
                    ‚úï
                  </button>
                )}
              </div>
            </div>

            {/* Results list */}
            <main className="flex-1 px-4 pt-4 pb-6 overflow-y-auto">
              <p className="text-xs text-slate-500 mb-2">Services</p>
              <div className="space-y-2">
                {filtered.map((s) => (
                  <button
                    key={s.id}
                    onClick={() => s.id === "newborn-cert" && onSelectService()}
                    className="w-full text-left"
                  >
                    <Card className="p-3 flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className="w-8 h-8 rounded-xl bg-teal-50 flex items-center justify-center">
                          <EmojiIcon symbol={s.id === "newborn-cert" ? "üë∂" : "üìÑ"} />
                        </div>
                        <div>
                          <p className="text-sm font-semibold text-slate-900">
                            {s.title}
                          </p>
                          <p className="text-[11px] text-slate-500">
                            {s.entity}
                          </p>
                        </div>
                      </div>
                      {s.id === "newborn-cert" ? (
                        <span className="text-[11px] text-teal-700 font-semibold">
                          Recommended
                        </span>
                      ) : (
                        <span className="text-[10px] text-slate-400">
                          (prototype: main flow only)
                        </span>
                      )}
                    </Card>
                  </button>
                ))}
              </div>
            </main>
          </div>
        </div>
      );
    };

    // --------- Service overview: As‚ÄëIs vs To‚ÄëBe ---------

    const ServiceOverview = ({ onBack, onSelectMode }) => {
      return (
        <div className="min-h-screen flex items-center justify-center bg-slate-50">
          <div className="phone-shell h-screen flex flex-col">
            <header className="px-4 pt-4 pb-3 flex items-center justify-between">
              <button
                onClick={onBack}
                className="text-xs text-slate-500 flex items-center gap-1"
              >
                ‚Üê Home
              </button>
              <span className="text-[11px] text-slate-500 font-semibold">
                Newborn Digital Birth Certificate
              </span>
              <div className="w-5" />
            </header>

            {/* Global CRM bar */}
            <div className="px-4 mb-3">
              <Card className="p-3 text-xs flex justify-between items-center">
                <div>
                  <p className="text-[11px] uppercase font-semibold text-slate-400">
                    CRM for this service
                  </p>
                  <p className="text-slate-700">
                    {CRM_GLOBAL.totalCases} complaints analysed
                  </p>
                  <p className="text-slate-500">
                    {CRM_GLOBAL.payment.count} payment issues ({CRM_GLOBAL.payment.share}%) ¬∑{" "}
                    {CRM_GLOBAL.technical.count} technical ({CRM_GLOBAL.technical.share}%)
                  </p>
                </div>
                <div className="text-[10px] text-rose-600 font-semibold text-right">
                  <EmojiIcon symbol="‚ö†Ô∏è" /> Very high friction
                </div>
              </Card>
            </div>

            <main className="flex-1 px-4 pb-6 overflow-y-auto">
              <p className="text-xs text-slate-500 mb-3">
                Compare the current TAMM journey with the redesigned seamless journey.
              </p>
              <div className="grid gap-4">
                {/* As‚ÄëIs card */}
                <button
                  onClick={() => onSelectMode("asis")}
                  className="text-left"
                >
                  <Card className="p-4">
                    <div className="flex justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <EmojiIcon symbol="‚è≥" />
                        <div>
                          <p className="text-[11px] text-slate-500 font-semibold">
                            Current state
                          </p>
                          <p className="text-sm font-semibold text-slate-900">
                            As‚ÄëIs journey
                          </p>
                        </div>
                      </div>
                      <span className="text-[11px] text-rose-600 font-semibold">
                        26% payment issues
                      </span>
                    </div>
                    <p className="text-xs text-slate-600 mb-2">
                      Manual data entry, repeated uploads, split payments and delayed rejections.
                    </p>
                    <ul className="text-[11px] text-rose-700 space-y-1">
                      <li>‚Ä¢ Confusing birth notification selection</li>
                      <li>‚Ä¢ Re‚Äëuploading documents already in ICP / Malafi</li>
                      <li>‚Ä¢ Separate Arabic & English fees</li>
                      <li>‚Ä¢ Name mismatch rejections after several days</li>
                    </ul>
                  </Card>
                </button>

                {/* To‚ÄëBe card */}
                <button
                  onClick={() => onSelectMode("tobe")}
                  className="text-left"
                >
                  <Card className="p-4 bg-gradient-to-br from-teal-600 to-teal-800 text-white">
                    <div className="flex justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <EmojiIcon symbol="‚ö°Ô∏è" />
                        <div>
                          <p className="text-[11px] text-teal-100 font-semibold">
                            Future state
                          </p>
                          <p className="text-sm font-semibold">
                            To‚ÄëBe journey
                          </p>
                        </div>
                      </div>
                      <span className="text-[11px] text-emerald-200 font-semibold">
                        1 journey ¬∑ 0 uploads
                      </span>
                    </div>
                    <p className="text-xs text-teal-100 mb-2">
                      Proactive Mabrouk Ma Yak bundle triggered from Malafi & ICP. Smart naming,
                      single payment, instant documents.
                    </p>
                    <ul className="text-[11px] text-teal-100 space-y-1">
                      <li>‚Ä¢ Notification instead of searching for the service</li>
                      <li>‚Ä¢ Auto‚Äëfetched documents from back‚Äëend systems</li>
                      <li>‚Ä¢ AI‚Äëassisted naming with validation</li>
                      <li>‚Ä¢ Payment recovery for failed / pending payments</li>
                    </ul>
                  </Card>
                </button>
              </div>
            </main>
          </div>
        </div>
      );
    };

    // --------- As‚ÄëIs Journey (same structure as before) ---------

    const AsIs = ({ onBack, onJumpToToBe }) => {
      const [step, setStep] = useState(1);
      const [notif, setNotif] = useState("");
      const [nameEn, setNameEn] = useState("");
      const [nameAr, setNameAr] = useState("");
      const [langs, setLangs] = useState({ ar: false, en: false });
      const [rejected, setRejected] = useState(false);

      // Step 1: service detail & process
      if (step === 1) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-slate-500 font-semibold">
                  As‚ÄëIs ¬∑ TAMM
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h1 className="text-xl font-bold text-slate-900 mb-1">
                  Issue a Newborn Digital Birth Certificate
                </h1>
                <p className="text-xs text-slate-500 mb-3">
                  Through this service, you can request the issuance of a digital birth certificate
                  for a newborn. If desired, the certificate can be attested for international use.
                </p>

                <Card className="p-4 mb-4">
                  <h2 className="text-sm font-semibold text-slate-900 mb-2">
                    Required documents
                  </h2>
                  <p className="text-[11px] text-slate-500 mb-2">
                    These are available in My TAMM:
                  </p>
                  <p className="text-xs text-slate-700 mb-2">
                    ‚Ä¢ Emirates ID (Parents‚Äô Emirates Identity)
                  </p>
                  <p className="text-[11px] text-slate-500 mb-1">
                    The following must be submitted during the application process:
                  </p>
                  <p className="text-xs text-slate-700">‚Ä¢ Parents‚Äô passports</p>
                  <p className="text-xs text-slate-700">‚Ä¢ Marriage contract</p>
                </Card>

                <Card className="p-4 mb-4 text-xs">
                  <h2 className="text-sm font-semibold text-slate-900 mb-2">Costs</h2>
                  <p className="text-[11px] text-slate-500 mb-2">
                    Payment methods: AD Pay, debit / credit card
                  </p>
                  <div className="space-y-1">
                    <div className="flex justify-between">
                      <span>Issuance fees for a certificate in English</span>
                      <span className="font-semibold">AED 50.00</span>
                    </div>
                    <div className="flex justify-between">
                      <span>Issuance fees for a certificate in Arabic</span>
                      <span className="font-semibold">AED 50.00</span>
                    </div>
                    <div className="flex justify-between">
                      <span>Attestation fee by Ministry of Foreign Affairs (optional)</span>
                      <span className="font-semibold">AED 150.00</span>
                    </div>
                  </div>
                </Card>

                <Card className="p-4 mb-3">
                  <h2 className="text-sm font-semibold text-slate-900 mb-2">
                    The process
                  </h2>
                  <ol className="space-y-2 text-xs text-slate-700">
                    <li>1. Log in using UAE PASS.</li>
                    <li>2. Submit the application and the required documents.</li>
                    <li>3. Pay the fees.</li>
                    <li>4. Receive the digital birth certificate.</li>
                  </ol>
                </Card>

                <CRMPanel
                  stageKey="service"
                  onSeeToBe={() => onJumpToToBe(0)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  onClick={() => setStep(2)}
                >
                  Start As‚ÄëIs journey ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 2: select notification
      if (step === 2) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={() => setStep(1)}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Service
                </button>
                <span className="text-[11px] text-slate-500 font-semibold">
                  Step 1 of 5
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Select birth notification
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Parents must choose the correct notification number before they can proceed.
                </p>

                <Card className="p-4 mb-3 text-xs">
                  <label className="block text-[11px] font-medium text-slate-600 mb-1">
                    Birth notification number
                  </label>
                  <select
                    className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm bg-slate-50"
                    value={notif}
                    onChange={(e) => setNotif(e.target.value)}
                  >
                    <option value="">Select notification‚Ä¶</option>
                    <option value="AD/BTH‚ÄëNC/0030214/2024">AD/BTH‚ÄëNC/0030214/2024</option>
                    <option value="AD/BTH‚ÄëNC/0031020/2024">AD/BTH‚ÄëNC/0031020/2024</option>
                    <option value="AG/BTH/MC/0032292/2024">AG/BTH/MC/0032292/2024</option>
                  </select>

                  <div className="mt-3 bg-rose-50 border border-rose-100 rounded-2xl p-2.5 text-rose-700">
                    <p className="font-semibold mb-1">Sample CRM complaint</p>
                    <p>
                      Case 240909‚Äë5038613: ‚ÄúWhen I select the birth notification number, an
                      unexpected error appears and I cannot move to the next step.‚Äù
                    </p>
                  </div>
                </Card>

                <CRMPanel
                  stageKey="notification"
                  onSeeToBe={() => onJumpToToBe(0)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  disabled={!notif}
                  onClick={() => setStep(3)}
                >
                  Continue ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 3: upload documents
      if (step === 3) {
        const docs = [
          "Father passport",
          "Mother passport",
          "Marriage contract",
          "Family book",
          "Father Emirates ID",
          "Mother Emirates ID"
        ];
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={() => setStep(2)}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Notification
                </button>
                <span className="text-[11px] text-slate-500 font-semibold">
                  Step 2 of 5
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Upload documents
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Parents re‚Äëupload documents that already exist in ICP and Malafi.
                </p>

                <Card className="p-4 mb-3 text-xs">
                  <div className="space-y-2">
                    {docs.map((d) => (
                      <div
                        key={d}
                        className="flex items-center justify-between border border-dashed border-slate-300 rounded-xl px-3 py-2 bg-slate-50"
                      >
                        <span>{d}</span>
                        <span className="text-teal-700 font-semibold text-[11px]">
                          Upload
                        </span>
                      </div>
                    ))}
                  </div>

                  <div className="mt-3 bg-amber-50 border border-amber-100 rounded-2xl p-2.5 text-amber-800">
                    ‚ÄúOnce I submit all required documents I get an error and the page does not move
                    forward in the newborn digital birth certificate service.‚Äù
                  </div>
                </Card>

                <CRMPanel
                  stageKey="documents"
                  onSeeToBe={() => onJumpToToBe(2)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  onClick={() => setStep(4)}
                >
                  Continue ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 4: baby details & naming
      if (step === 4) {
        const canContinue = nameEn && nameAr;
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={() => setStep(3)}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Documents
                </button>
              <span className="text-[11px] text-slate-500 font-semibold">
                  Step 3 of 5
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Baby details
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Names are typed manually in English and Arabic with no validation.
                </p>

                <Card className="p-4 mb-3 text-xs">
                  <div className="space-y-3">
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Baby name (English)
                      </label>
                      <input
                        type="text"
                        className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm"
                        placeholder="e.g. Zayed"
                        value={nameEn}
                        onChange={(e) => setNameEn(e.target.value)}
                      />
                    </div>
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Baby name (Arabic)
                      </label>
                      <input
                        type="text"
                        className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm text-right"
                        placeholder="e.g. ÿ≤ÿßŸäÿØ"
                        value={nameAr}
                        onChange={(e) => setNameAr(e.target.value)}
                      />
                    </div>
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Nationality
                      </label>
                      <select className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm">
                        <option>United Arab Emirates</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Religion
                      </label>
                      <select className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm">
                        <option>Islam</option>
                      </select>
                    </div>
                    <p className="text-[10px] text-slate-400">
                      * If the Arabic and English spelling do not match ICP rules, the request may be
                      rejected after submission.
                    </p>
                  </div>

                  <div className="mt-3 text-[11px] bg-rose-50 border border-rose-100 rounded-2xl p-2.5 text-rose-700">
                    ‚ÄúI tried to complete the newborn details but the form freezes and I cannot reach
                    the payment step or correct the name.‚Äù
                  </div>
                </Card>

                <CRMPanel
                  stageKey="naming"
                  onSeeToBe={() => onJumpToToBe(1)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  disabled={!canContinue}
                  onClick={() => setStep(5)}
                >
                  Continue ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 5: language & payment
      if (step === 5) {
        const total =
          (langs.ar ? 50 : 0) +
          (langs.en ? 50 : 0);
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={() => setStep(4)}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Baby details
                </button>
                <span className="text-[11px] text-slate-500 font-semibold">
                  Step 4 of 5
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Choose certificates & pay
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Parents pay separately for Arabic and English certificates, increasing cost and
                  complexity.
                </p>

                <Card className="p-4 mb-3 text-xs">
                  <label className="flex items-center justify-between border border-slate-200 rounded-xl px-3 py-2 mb-2">
                    <span>Arabic certificate</span>
                    <span className="flex items-center gap-2">
                      <span className="font-semibold">AED 50.00</span>
                      <input
                        type="checkbox"
                        checked={langs.ar}
                        onChange={() =>
                          setLangs((s) => ({ ...s, ar: !s.ar }))
                        }
                      />
                    </span>
                  </label>
                  <label className="flex items-center justify-between border border-slate-200 rounded-xl px-3 py-2">
                    <span>English certificate</span>
                    <span className="flex items-center gap-2">
                      <span className="font-semibold">AED 50.00</span>
                      <input
                        type="checkbox"
                        checked={langs.en}
                        onChange={() =>
                          setLangs((s) => ({ ...s, en: !s.en }))
                        }
                      />
                    </span>
                  </label>
                  <div className="mt-3 border-t border-slate-200 pt-2 flex justify-between text-xs">
                    <span className="font-semibold">Total</span>
                    <span className="font-bold text-teal-700">
                      AED {total.toFixed(2)}
                    </span>
                  </div>

                  <div className="mt-3 text-[11px] bg-rose-50 border border-rose-100 rounded-2xl p-2.5 text-rose-700">
                    ‚ÄúI already paid but the application still shows pending payment and I cannot get
                    the certificate.‚Äù
                  </div>
                </Card>

                <CRMPanel
                  stageKey="payment"
                  onSeeToBe={() => onJumpToToBe(4)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  disabled={total === 0}
                  onClick={() => setStep(6)}
                >
                  Pay AED {total.toFixed(2)}
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 6: processing & possible rejection
      if (step === 6) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={() => setStep(5)}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Payment
                </button>
                <span className="text-[11px] text-slate-500 font-semibold">
                  Step 5 of 5
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <Card className="p-5 mb-3 text-center">
                  {!rejected ? (
                    <>
                      <div className="w-14 h-14 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-3">
                        <EmojiIcon symbol="‚è±Ô∏è" />
                      </div>
                      <h2 className="text-lg font-bold text-slate-900 mb-1">
                        Request submitted
                      </h2>
                      <p className="text-xs text-slate-500 mb-3">
                        Your application is under review. CRM data shows many parents waiting
                        several days at this step.
                      </p>
                      <Button
                        variant="secondary"
                        className="w-full h-9 text-sm"
                        onClick={() => setRejected(true)}
                      >
                        Simulate: 2 days later ‚Üí
                      </Button>
                    </>
                  ) : (
                    <>
                      <div className="w-14 h-14 rounded-full bg-rose-100 flex items-center justify-center mx-auto mb-3">
                        <EmojiIcon symbol="‚ùå" />
                      </div>
                      <h2 className="text-lg font-bold text-slate-900 mb-1">
                        Application rejected
                      </h2>
                      <p className="text-xs text-slate-500 mb-3">
                        Parents discover the rejection only later, with no clear way to correct the
                        name and resubmit.
                      </p>
                      <div className="bg-rose-50 border border-rose-200 rounded-2xl p-3 text-xs text-rose-800 mb-3">
                        <p className="font-semibold mb-1">Rejection reason</p>
                        <p>
                          Name mismatch. The Arabic name does not match the English spelling as per
                          ICP naming rules. A new application with new fees is required.
                        </p>
                      </div>
                    </>
                  )}
                </Card>

                <CRMPanel
                  stageKey="status"
                  onSeeToBe={() => onJumpToToBe(5)}
                />
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  variant="secondary"
                  onClick={onBack}
                >
                  Back to overview
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      return null;
    };

    // --------- To‚ÄëBe journey with advanced AI naming ----------

    const ToBe = ({ onBack, initialStep = 0 }) => {
      const [step, setStep] = useState(initialStep || 0);
      const [nameEn, setNameEn] = useState("");
      const [nameAr, setNameAr] = useState("");
      const [addMofa, setAddMofa] = useState(false);
      const [selectedGender, setSelectedGender] = useState("boy");
      const [selectedInitial, setSelectedInitial] = useState(null);
      const [aiSuggestions, setAiSuggestions] = useState([]);

      useEffect(() => {
        setStep(initialStep || 0);
      }, [initialStep]);

      const total = 275 + (addMofa ? 150 : 0);
      const isNameConfirmed = nameEn && nameAr;

      const availableLetters = Array.from(
        new Set(
          NAME_LIBRARY.filter((n) => n.gender === selectedGender).map((n) => n.initial)
        )
      ).sort();

      const handleSuggest = () => {
        let filtered = NAME_LIBRARY.filter((n) => n.gender === selectedGender);
        if (selectedInitial) {
          filtered = filtered.filter((n) => n.initial === selectedInitial);
        }
        if (filtered.length === 0) {
          filtered = NAME_LIBRARY.filter((n) => n.gender === selectedGender);
        }
        setAiSuggestions(filtered);
      };

      // Step 0 ‚Äì proactive notification
      if (step === 0) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-900 text-white">
            <div className="phone-shell h-screen flex flex-col justify-between px-6 py-6">
              <header className="flex items-center justify-between mb-6">
                <button
                  onClick={onBack}
                  className="text-xs text-teal-100 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-teal-100 font-semibold">
                  To‚ÄëBe ¬∑ Mabrouk Ma Yak
                </span>
                <div className="w-5" />
              </header>

              <div className="flex-1 flex items-center">
                <Card className="bg-white text-slate-900 border-none shadow-2xl p-4 w-full">
                  <div className="flex items-start gap-3 text-xs">
                    <EmojiIcon symbol="üë∂" />
                    <div>
                      <p className="font-semibold mb-1">Mabrouk Ma Yak!</p>
                      <p className="text-slate-600">
                        We received a birth notification from the hospital for your newborn.
                        Tap to name your baby and issue all documents in one journey.
                      </p>
                      <p className="text-[10px] text-slate-400 mt-1">Just now ¬∑ from Malafi</p>
                    </div>
                  </div>
                </Card>
              </div>

              <Button
                className="w-full h-11 bg-white text-slate-900"
                variant="secondary"
                onClick={() => setStep(1)}
              >
                Start naming journey ‚Üí
              </Button>
            </div>
          </div>
        );
      }

      // Step 1 ‚Äì smart naming with gender + initial + meaning
      if (step === 1) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-emerald-700 font-semibold">
                  To‚ÄëBe ¬∑ Naming
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Name your baby (smart)
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Choose gender and preferred first letter, then let AI suggest names with
                  meanings. Arabic and English are checked against ICP rules.
                </p>

                <Card className="p-4 mb-3 text-xs">
                  {/* Manual input */}
                  <div className="space-y-3 mb-3">
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Name (English)
                      </label>
                      <input
                        className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm"
                        placeholder="e.g. Zayed"
                        value={nameEn}
                        onChange={(e) => setNameEn(e.target.value)}
                      />
                    </div>
                    <div>
                      <label className="block text-[11px] font-medium text-slate-600 mb-1">
                        Name (Arabic)
                      </label>
                      <input
                        className="w-full border border-slate-300 rounded-xl px-3 py-2 text-sm text-right"
                        placeholder="e.g. ÿ≤ÿßŸäÿØ"
                        value={nameAr}
                        onChange={(e) => setNameAr(e.target.value)}
                      />
                    </div>
                  </div>

                  <div className="relative flex py-2 items-center">
                    <div className="flex-grow border-t border-slate-200" />
                    <span className="flex-shrink-0 mx-4 text-[10px] text-slate-400 uppercase tracking-wide">
                      or use AI
                    </span>
                    <div className="flex-grow border-t border-slate-200" />
                  </div>

                  {/* AI helper */}
                  <div className="bg-violet-50 border border-violet-100 rounded-2xl p-3">
                    {/* Gender toggle */}
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-[11px] font-semibold text-violet-700">
                        AI name helper
                      </span>
                      <div className="flex text-[11px] bg-white rounded-full p-0.5">
                        <button
                          className={
                            "px-2 py-0.5 rounded-full " +
                            (selectedGender === "boy"
                              ? "bg-violet-600 text-white"
                              : "text-violet-700")
                          }
                          onClick={() => {
                            setSelectedGender("boy");
                            setSelectedInitial(null);
                            setAiSuggestions([]);
                          }}
                        >
                          Boy
                        </button>
                        <button
                          className={
                            "px-2 py-0.5 rounded-full " +
                            (selectedGender === "girl"
                              ? "bg-violet-600 text-white"
                              : "text-violet-700")
                          }
                          onClick={() => {
                            setSelectedGender("girl");
                            setSelectedInitial(null);
                            setAiSuggestions([]);
                          }}
                        >
                          Girl
                        </button>
                      </div>
                    </div>

                    {/* First letter row */}
                    <div className="mb-2">
                      <p className="text-[10px] text-slate-500 mb-1">
                        Choose first letter (optional)
                      </p>
                      <div className="flex flex-wrap gap-1">
                        {availableLetters.map((letter) => (
                          <button
                            key={letter}
                            className={
                              "px-2 py-0.5 rounded-full text-[11px] border " +
                              (selectedInitial === letter
                                ? "bg-violet-600 text-white border-violet-600"
                                : "bg-white text-violet-700 border-violet-200")
                            }
                            onClick={() =>
                              setSelectedInitial((prev) =>
                                prev === letter ? null : letter
                              )
                            }
                          >
                            {letter}
                          </button>
                        ))}
                      </div>
                    </div>

                    <Button
                      variant="secondary"
                      className="w-full h-8 text-[11px] mt-1"
                      onClick={handleSuggest}
                    >
                      Generate name suggestions
                    </Button>

                    {aiSuggestions.length > 0 && (
                      <div className="mt-3 space-y-2 animate-fade-in">
                        {aiSuggestions.map((n) => (
                          <button
                            key={n.en}
                            className="w-full text-left bg-white border border-violet-100 rounded-xl px-3 py-2 hover:border-violet-300"
                            onClick={() => {
                              setNameEn(n.en);
                              setNameAr(n.ar);
                            }}
                          >
                            <div className="flex justify-between items-center">
                              <span className="text-sm font-semibold text-slate-900">
                                {n.en} / {n.ar}
                              </span>
                              <span className="text-[10px] text-violet-600 font-semibold">
                                {n.gender === "boy" ? "Boy" : "Girl"}
                              </span>
                            </div>
                            <p className="text-[10px] text-slate-500 mt-1">
                              Meaning: {n.meaning}
                            </p>
                          </button>
                        ))}
                      </div>
                    )}
                  </div>

                  {isNameConfirmed && (
                    <div className="mt-3 rounded-2xl bg-emerald-50 border border-emerald-100 p-2.5 text-[11px] text-emerald-800">
                      <p className="font-semibold mb-1">Name verified</p>
                      <p>
                        Arabic and English forms match ICP naming rules. No name mismatch
                        rejection at issuance.
                      </p>
                    </div>
                  )}
                </Card>
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  disabled={!isNameConfirmed}
                  onClick={() => setStep(2)}
                >
                  Confirm name and continue ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 2 ‚Äì docs auto fetched
      if (step === 2) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-emerald-700 font-semibold">
                  To‚ÄëBe ¬∑ Docs
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Documents (auto‚Äëfetched)
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  All required documents are pulled from ICP and back‚Äëend systems. No uploads, no
                  eligibility surprises.
                </p>

                <Card className="p-4 text-xs space-y-3">
                  {[
                    "Father‚Äôs ID & passport ‚Äì Retrieved from ICP",
                    "Mother‚Äôs ID & passport ‚Äì Retrieved from ICP",
                    "Marriage contract ‚Äì Verified by Ministry of Justice"
                  ].map((t) => (
                    <div
                      key={t}
                      className="flex items-center justify-between rounded-2xl border border-emerald-100 bg-emerald-50 px-3 py-2"
                    >
                      <span>{t}</span>
                      <span>‚úî</span>
                    </div>
                  ))}
                </Card>
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  onClick={() => setStep(3)}
                >
                  Continue ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 3 ‚Äì bundle
      if (step === 3) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-emerald-700 font-semibold">
                  To‚ÄëBe ¬∑ Bundle
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Mabrouk Ma Yak bundle
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  Birth certificate, Emirates ID and passport are combined into one bundle with a
                  clear fee breakdown.
                </p>

                <Card className="p-4 text-xs">
                  <div className="bg-slate-50 rounded-2xl p-3 mb-3">
                    <p className="text-[11px] font-semibold text-slate-500 mb-2">
                      Fee breakdown
                    </p>
                    <div className="flex justify-between mb-1">
                      <span>Birth certificate</span>
                      <span className="font-semibold">AED 50.00</span>
                    </div>
                    <div className="flex justify-between mb-1">
                      <span>Emirates ID (newborn)</span>
                      <span className="font-semibold">AED 170.00</span>
                    </div>
                    <div className="flex justify-between mb-1">
                      <span>Passport issuance</span>
                      <span className="font-semibold">AED 55.00</span>
                    </div>
                    <div className="mt-2 pt-2 border-t border-slate-200 flex justify-between items-center">
                      <span className="font-semibold">Bundle total</span>
                      <span className="font-bold text-teal-700">AED 275.00</span>
                    </div>
                  </div>

                  <button
                    className={
                      "w-full text-left rounded-2xl border px-3 py-3 text-xs " +
                      (addMofa
                        ? "border-teal-600 bg-teal-50"
                        : "border-slate-200 bg-white")
                    }
                    onClick={() => setAddMofa((v) => !v)}
                  >
                    <p className="font-semibold text-slate-900">
                      Add MOFA attestation
                    </p>
                    <p className="text-[11px] text-slate-500">
                      Digital attestation from Ministry of Foreign Affairs is added automatically.
                    </p>
                    <p className="text-[11px] font-semibold text-teal-700 mt-1">
                      + AED 150.00
                    </p>
                  </button>
                </Card>
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  onClick={() => setStep(4)}
                >
                  Continue to payment ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 4 ‚Äì payment + recovery
      if (step === 4) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-emerald-700 font-semibold">
                  To‚ÄëBe ¬∑ Payment
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto">
                <h2 className="text-lg font-bold text-slate-900 mb-1">
                  Pay once
                </h2>
                <p className="text-xs text-slate-500 mb-3">
                  One payment covers the full bundle. A built‚Äëin recovery layer handles CRM payment
                  issues (‚Äúpaid but still pending‚Äù).
                </p>

                <Card className="p-4 text-xs">
                  <div className="mb-3 rounded-2xl bg-slate-900 text-white px-3 py-3 flex justify-between items-center">
                    <span>Total amount</span>
                    <span className="text-xl font-semibold">
                      AED {total.toFixed(2)}
                    </span>
                  </div>

                  <Button
                    className="w-full h-10 mb-2 bg-black text-white"
                    onClick={() => setStep(5)}
                  >
                    <EmojiIcon symbol="Ô£ø" /> Pay with Apple Pay
                  </Button>

                  <div className="mt-2 p-3 rounded-2xl bg-emerald-50 border border-emerald-100 text-xs text-emerald-800">
                    <p className="font-semibold mb-1">
                      Payment recovery
                    </p>
                    <p>
                      If your bank shows the amount as paid but TAMM is still ‚Äúpending payment‚Äù, the
                      system automatically reconciles the transaction using AD Pay logs and continues
                      without a new complaint.
                    </p>
                  </div>
                </Card>
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  variant="secondary"
                  onClick={() => setStep(5)}
                >
                  Simulate successful payment ‚Üí
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      // Step 5 ‚Äì success & digital locker
      if (step === 5) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="phone-shell h-screen flex flex-col">
              <header className="px-4 pt-4 pb-2 flex items-center justify-between">
                <button
                  onClick={onBack}
                  className="text-xs text-slate-500 flex items-center gap-1"
                >
                  ‚Üê Back
                </button>
                <span className="text-[11px] text-emerald-700 font-semibold">
                  To‚ÄëBe ¬∑ Success
                </span>
                <div className="w-5" />
              </header>

              <main className="flex-1 px-4 pb-4 overflow-y-auto text-center">
                <Card className="p-6 mt-4 text-xs">
                  <div className="w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-3">
                    <EmojiIcon symbol="‚úÖ" />
                  </div>
                  <h2 className="text-xl font-bold text-slate-900 mb-1">
                    Documents issued
                  </h2>
                  <p className="text-slate-500 mb-3">
                    Birth certificate, Emirates ID and passport are issued instantly and stored in
                    your digital locker.
                  </p>

                  <div className="bg-emerald-50 border border-emerald-100 rounded-2xl p-3 mb-3 text-emerald-800 text-left">
                    <p className="font-semibold mb-1">
                      CRM impact
                    </p>
                    <p>
                      Eliminates payment failures, document upload issues, and name mismatch
                      rejections for this journey.
                    </p>
                  </div>

                  <div className="bg-slate-50 border border-slate-200 rounded-2xl p-3 mb-3 text-left">
                    <p className="text-[11px] font-semibold text-slate-500 mb-2">
                      Digital locker
                    </p>
                    <div className="flex items-center justify-between bg-white rounded-xl px-3 py-2 mb-2 border border-slate-200">
                      <span>Birth certificate (PDF)</span>
                      <span>‚¨áÔ∏è</span>
                    </div>
                    <div className="flex items-center justify-between bg-black text-white rounded-xl px-3 py-2">
                      <span>Add to Apple Wallet</span>
                      <span>‚ûï</span>
                    </div>
                  </div>

                  <div className="bg-slate-900 text-white rounded-2xl p-4 text-left">
                    <p className="text-sm font-semibold mb-1">
                      Hospital kiosk pickup
                    </p>
                    <p className="text-[11px] text-slate-200 mb-2">
                      Scan this code at the hospital kiosk to print the newborn‚Äôs physical documents.
                    </p>
                    <div className="bg-white rounded-xl p-2 w-fit">
                      <EmojiIcon symbol="üî≥" />
                    </div>
                  </div>
                </Card>
              </main>

              <footer className="px-4 pb-4">
                <Button
                  className="w-full h-11"
                  variant="secondary"
                  onClick={onBack}
                >
                  Back to overview
                </Button>
              </footer>
            </div>
          </div>
        );
      }

      return null;
    };

    // --------- Root App ---------

    const App = () => {
      const [view, setView] = useState("splash"); // splash -> login -> home -> service -> asis/tobe
      const [toBeStep, setToBeStep] = useState(0);

      const jumpToToBe = (step) => {
        setToBeStep(step || 0);
        setView("tobe");
      };

      if (view === "splash") {
        return <Splash onNext={() => setView("login")} />;
      }
      if (view === "login") {
        return <UAEPassLogin onLogin={() => setView("home")} />;
      }
      if (view === "home") {
        return <Home onSelectService={() => setView("service")} />;
      }
      if (view === "service") {
        return (
          <ServiceOverview
            onBack={() => setView("home")}
            onSelectMode={(mode) => setView(mode)}
          />
        );
      }
      if (view === "asis") {
        return (
          <AsIs
            onBack={() => setView("service")}
            onJumpToToBe={jumpToToBe}
          />
        );
      }
      if (view === "tobe") {
        return (
          <ToBe
            onBack={() => setView("service")}
            initialStep={toBeStep}
          />
        );
      }
      return null;
    };

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
